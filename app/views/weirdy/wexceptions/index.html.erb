Show:
<%= link_to_if params[:state] != "opened" && params[:state].present?, "Opened", root_url('state' => 'opened') %>
<%= link_to_if params[:state] != "closed" || params[:state].blank?, "Closed", root_url('state' => 'closed') %>
<%= link_to_if params[:state] != "ignored" || params[:state].blank?, "Ignored", root_url('state' => 'ignored') %>

Order:
<%= link_to_if params[:order] != "last_happened_at" && params[:order].present?, 
  "Last Happened At", append_query_params('order' => 'last_happened_at') %>
<%= link_to_if params[:order] != "occurrences", 
  "Occurrences", append_query_params('order' => 'occurrences') %>
<table>
  <tr>
    <th>
      Kind
    </th>
    <th>
      Message
    </th>
    <th>
      Ocurrences
    </th>
    <th>
      First Happened At
    </th>
    <th>
      Last Happened At
    </th>
    <th>
      Actions
    </th>
    <th>
    </th>
  </tr>
  <% for wexception in @wexceptions %>
    <tr id="wexception_<%= wexception.id %>">
      <td>
        <%= wexception.kind %>
      </td>
      <td>
        <%= wexception.message %>
      </td>
      <td>
        <%= wexception.occurrences_count %>
      </td>
      <td>
        <%= time_ago_in_words wexception.first_happened_at %> ago
      </td>
      <td>
        <%= time_ago_in_words wexception.last_happened_at %> ago
      </td>
      <td>
        <%= state_change_links(wexception) %>
      </td>
      <td>
        <%= link_to "Occurrences", "#", class: "occurrences" %>
      </td>
    </tr>
    <tr class="occurrences">
      <td>
        <%= render 'occurrences', :occurrences => wexception.occurrences %>
      </td>
    </tr>
  <% end %>
</table>

<%= will_paginate @wexceptions %>

<%= javascript_tag do %>
  $(function() {
    weirdy.wexceptionsIndex.initialize();
  });
<% end %>
